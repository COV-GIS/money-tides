import{as as b,Z as h,at as n,M as g,m,b as S}from"./money-tides-jsxFactory-B_9qB7yw.js";import"./money-tides-config-Dy31BTur.js";import{ds as u,aJ as A,e5 as w,gb as a}from"./money-tides-app-config-ClMBcfMD.js";import{g as y}from"./money-tides-MoneyTides-CyABS0cb.js";import"./index-D3fz2Vbf.js";import"./money-tides-index-Bz5uSspo.js";import"./money-tides-runtime-BTGwkf2p.js";import"./money-tides-ReactiveMap-CNCn77NR.js";import"./money-tides-messageBundle-GAipSWXq.js";import"./money-tides-index-BSQMl5Dg.js";var _=Object.defineProperty,C=Object.getOwnPropertyDescriptor,d=(e,t,s,o)=>{for(var i=o>1?void 0:o?C(t,s):t,l=e.length-1,c;l>=0;l--)(c=e[l])&&(i=(o?c(t,s,i):c(i))||i);return o&&i&&_(t,s,i),i};const p="advisory-item",f={advisory:`${p}_advisory`,content:`${p}_content`},v="advisory-item-content-handle";let r=class extends b{constructor(e){super(e),this.hidden=!0,this.content=null}get container(){return this._container}set container(e){this._container=e}postInitialize(){const{feature:e}=this;e.symbol=this.createSymbol(e.attributes.prod_type),this.addHandles(h(()=>u.colorType,this.createSymbol.bind(this,e.attributes.prod_type))),this.addHandles(h(()=>this.hidden,()=>{this.removeHandles(v),this.getAdvisory()}),v)}createSymbol(e){const t=e.toLowerCase(),s=t.includes("outage")||t.includes("advisory")||t.includes("statement")||t.includes("outlook")||t.includes("forecast")?y("--calcite-color-status-info"):t.includes("watch")||t.includes("alert")?y("--calcite-color-status-warning"):t.includes("outage")||t.includes("emergency")||t.includes("warning")||t.includes("immediate")||t.includes("danger")?y("--calcite-color-status-danger"):"#fff",o=new A(s).toRgb();return new w({data:{type:"CIMSymbolReference",symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[...o,64]},{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[4.75,4.75],lineDashEnding:"HalfPattern",offsetAlongLine:0}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[...o,255]}]}}})}async getAdvisory(){const{attributes:{url:e}}=this;this.content=n("calcite-loader",{label:"Loading advisory..."});try{const t=await(await fetch(e)).json(),{areaDesc:s,description:o,instruction:i}=t.properties,l=o.split(`

`);this.content=n("div",{class:f.advisory},n("div",null,s),l.map(c=>c.includes("https")?null:n("div",null,c.replace("* ",""))),i?n("div",null,i.replace(`
`," ").replace("  "," ")):null)}catch(t){console.log("advisory content",t),this.content=n("calcite-notice",{icon:a.error,kind:"danger",open:!0,scale:u.scale},n("div",{slot:"message"},"An error occurred loading advisory info"),n("calcite-link",{slot:"link",onclick:this.getAdvisory.bind(this)},"Try again"))}}iconAndStyle(e){const t=e.toLowerCase(),s=t.includes("outage")||t.includes("advisory")||t.includes("statement")||t.includes("outlook")||t.includes("forecast")?{icon:a.info,style:"--calcite-color-status-info"}:t.includes("watch")||t.includes("alert")?{icon:a.alert,style:"--calcite-color-status-warning"}:t.includes("outage")||t.includes("emergency")||t.includes("warning")||t.includes("immediate")||t.includes("danger")?{icon:a.danger,style:"--calcite-color-status-danger"}:{icon:"",style:""};return{icon:s.icon,style:`--calcite-list-label-text-color: var(${s.style}); --calcite-list-icon-color: var(${s.style});`}}render(){const{colorType:e,scale:t}=u,{attributes:{expiration:s,prod_type:o},content:i,hidden:l}=this,c=g.fromISO(s).setZone("America/Los_Angeles");return g.now().setZone("America/Los_Angeles")>c&&(this.visible=!1),n("calcite-list-item",{class:p,description:`Expires ${c.toFormat("ccc h:mm a")}`,"icon-start":this.iconAndStyle(o).icon,label:o,scale:t,style:e==="dark"?this.iconAndStyle(o).style:this.iconAndStyle(o).style},n("div",{class:f.content,hidden:l,slot:"content-bottom"},i))}};d([m()],r.prototype,"hidden",2);d([m({aliasOf:"feature.attributes"})],r.prototype,"attributes",2);d([m()],r.prototype,"content",2);r=d([S("AdvisoryItem")],r);export{r as default};
