import{I as u,a7 as c,ee as y,v as f,cx as m,iE as p,e5 as v,dq as P}from"./index-CHqIbA-u.js";import{v as l}from"./money-tides-PivotQuery-CK9i8o5o.js";function g(i){const t=p(i),e=t.outPivots;if(e?.length){for(const o of e)o.pivotType==="Pivot"&&o.pivotParameters.outStatistic?o.pivotParameters.outStatistic=JSON.stringify(o.pivotParameters.outStatistic):o.pivotType==="Unpivot"&&(o.unPivotParameters.sourceFields=o.unPivotParameters.sourceFields.join(","));t.outPivots=JSON.stringify(e)}return t}async function S(i,t,e){return await q(i,t,e)}async function q(i,t,e={}){const o=typeof i=="string"?u(i):i,r=t.geometry?[t.geometry]:[],a=await c(r,null,{signal:e.signal}),n=a?.[0];n!=null&&((t=t.clone()).geometry=n);const s=y({...o.query,f:"json",...g(t)});return f(m(o.path,"queryPivot"),{...e,query:{...s,...e.query}})}async function w(i,t,e){const o=v(i),r={...e},{data:a}=await S(o,l.from(t),r);return P.fromJSON(a)}export{w as executePivotQuery};
