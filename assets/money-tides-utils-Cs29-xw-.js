const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/money-tides-symbolLayerUtils-DWOxs11p.js","assets/index-DWCK4KRz.js","assets/index-BU23byjB.css","assets/money-tides-jsxFactory-CmVu17M-.js","assets/money-tides-config-Dy31BTur.js","assets/money-tides-index-Bz5uSspo.js","assets/money-tides-runtime-BTGwkf2p.js","assets/runtime-OCMtRbrJ.css","assets/money-tides-app-config-dTmgntDM.js","assets/money-tides-ReactiveMap-DFuaAS07.js","assets/money-tides-messageBundle-BOeQ4wnZ.js","assets/money-tides-index-BSQMl5Dg.js"])))=>i.map(i=>d[i]);
import{_ as b}from"./index-DWCK4KRz.js";import{b9 as w,aJ as s,f9 as y,fa as m,fb as k,fc as g,fd as L}from"./money-tides-app-config-dTmgntDM.js";import"./money-tides-config-Dy31BTur.js";import"./money-tides-jsxFactory-CmVu17M-.js";import{S as v,u as z}from"./money-tides-cimSymbolUtils-CpJcKopd.js";new w(1e3);new s([128,128,128]);function T(r){if(r==null||!("symbolLayers"in r)||r.symbolLayers==null)return!1;switch(r.type){case"point-3d":return r.symbolLayers.some(n=>n.type==="object");case"line-3d":return r.symbolLayers.some(n=>n.type==="path");case"polygon-3d":return r.symbolLayers.some(n=>n.type==="object"||n.type==="extrude");default:return!1}}function U(r){return r.resource?.href??""}function V(r,n){if(!r)return null;let o=null;return y(r)?o=S(r):m(r)&&(o=r.type==="cim"?z(r):r.color?new s(r.color):null),o?u(o,n):null}function S(r){const n=r.symbolLayers;if(!n)return null;let o=null;return n.forEach(l=>{l.type==="object"&&l.resource?.href||(o=l.type==="water"?l.color:l.material?l.material.color:null)}),o?new s(o):null}function u(r,n){if(n==null||r==null)return r;const o=r.toRgba();return o[3]=o[3]*n,new s(o)}function _(r,n,o){const l=r.symbolLayers;if(!l)return;const e=(t,c=!1)=>{let i=n??t??null;return o?.override!=null&&(!i&&c&&(i=new s([255,255,255])),i&&(i.a=o.override)),u(i,o?.add)};l.forEach(t=>{if(t.type==="water")return void(t.color=u(t.color,o?.add));const c=t.material!=null?t.material.color:null,i=e(c,t.type==="icon"&&t.resource?.href!=null);t.material==null?t.material=new k({color:i}):t.material.color=i,"outline"in t&&t.outline?.color&&o?.add!=null&&(t.outline.color=u(t.outline.color,o.add)),"marker"in t&&t.marker!=null&&(t.marker.color=e(t.marker.color))})}function x(r,n,o){n=n??r.color,o?.override!=null&&n&&(n.a=o.override),n&&(r.color=u(n,o?.add)),"outline"in r&&r.outline?.color&&(r.outline.color=u(r.outline.color,o?.add))}function q(r,n,o){r&&(n||o!=null)&&(n&&(n=new s(n)),y(r)?_(r,n,o):m(r)&&x(r,n,o))}async function j(r,n){const o=r.symbolLayers;o&&await g(o,async l=>E(l,n))}async function E(r,n){switch(r.type){case"extrude":R(r,n);break;case"icon":case"line":case"text":$(r,n);break;case"path":A(r,n);break;case"object":await O(r,n)}}function $(r,n){const o=h(n);o!=null&&(r.size=o)}function h(r){for(const n of r)if(typeof n=="number")return n;return null}function R(r,n){const o=n[2];typeof o=="number"&&(r.size=o)}async function O(r,n){const{resourceSize:o,symbolSize:l}=await D(r),e=p(n,o,l);e!=null&&(r.width=f(n[0],l[0],o[0],e),r.depth=f(n[1],l[1],o[1],e),r.height=f(n[2],l[2],o[2],e))}function A(r,n){const o=p(n,L,[r.width,void 0,r.height]);o!=null&&(r.width=f(n[0],r.width,1,o),r.height=f(n[2],r.height,1,o))}function p(r,n,o){for(let l=0;l<3;l++){const e=r[l];switch(e){case"symbol-value":{const t=o[l];return t!=null?t/n[l]:1}case"proportional":break;default:if(e&&n[l])return e/n[l]}}return null}async function D(r){const{computeObjectLayerResourceSize:n}=await b(()=>import("./money-tides-symbolLayerUtils-DWOxs11p.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])),o=await n(r,10),{width:l,height:e,depth:t}=r,c=[l,t,e];let i=1;for(let a=0;a<3;a++){const d=c[a];if(d!=null){i=d/o[a];break}}for(let a=0;a<3;a++)c[a]==null&&(c[a]=o[a]*i);return{resourceSize:o,symbolSize:c}}function f(r,n,o,l){switch(r){case"proportional":return o*l;case"symbol-value":return n??o;default:return r}}function J(r,n){const o=h(n);if(o!=null)switch(r.type){case"simple-marker":r.size=o;break;case"picture-marker":{const l=r.width/r.height;l>1?(r.width=o,r.height=o*l):(r.width=o*l,r.height=o);break}case"simple-line":r.width=o;break;case"text":r.font.size=o}}async function B(r,n){if(r&&n)return y(r)?j(r,n):void(m(r)&&J(r,n))}function F(r,n,o){if(r&&n!=null){if(y(r)){const l=r.symbolLayers;l&&l.forEach(e=>{if(e.type==="object")switch(o){case"tilt":e.tilt=(e.tilt??0)+n;break;case"roll":e.roll=(e.roll??0)+n;break;default:e.heading=(e.heading??0)+n}e.type==="icon"&&(e.angle+=n)})}else if(m(r))switch(r.type){case"simple-marker":case"picture-marker":case"text":r.angle+=n;break;case"cim":v(r,n,!0)}}}function G(r){return r!=null&&r.type==="polygon-3d"&&r.symbolLayers.some(n=>n.type==="extrude")}export{G as A,q as L,B as M,F as N,V as b,U as d,T as h};
