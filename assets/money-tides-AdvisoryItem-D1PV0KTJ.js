import{as as S,Z as m,at as o,M as f,m as p,b as w}from"./money-tides-jsxFactory-WyPyzVz8.js";import"./money-tides-config-Dy31BTur.js";import{ds as u,aJ as A,e5 as _,gb as l}from"./money-tides-app-config-BgjokkMS.js";import{g as y}from"./money-tides-MoneyTides-BX6qSy0u.js";import"./index-C6V24ubA.js";import"./money-tides-index-Bz5uSspo.js";import"./money-tides-runtime-BTGwkf2p.js";import"./money-tides-ReactiveMap-CB-zf1xB.js";import"./money-tides-messageBundle-BRui5_bj.js";import"./money-tides-index-BSQMl5Dg.js";var I=Object.defineProperty,C=Object.getOwnPropertyDescriptor,d=(t,e,s,i)=>{for(var n=i>1?void 0:i?C(e,s):e,r=t.length-1,c;r>=0;r--)(c=t[r])&&(n=(i?c(e,s,n):c(n))||n);return i&&n&&I(e,s,n),n};const h="advisory-item",g={advisory:`${h}_advisory`,content:`${h}_content`},v="advisory-item-content-handle";let a=class extends S{constructor(t){super(t),this.hidden=!0,this.content=null}get container(){return this._container}set container(t){this._container=t}postInitialize(){const{feature:t}=this;t.symbol=this.createSymbol(t.attributes.prod_type),this.addHandles(m(()=>u.colorType,this.createSymbol.bind(this,t.attributes.prod_type))),this.addHandles(m(()=>this.hidden,()=>{this.removeHandles(v),this.getAdvisory()}),v)}clear(){this.emit("hide-graphic"),this.container.selected=!1,this.hidden=!0}createSymbol(t){const e=t.toLowerCase(),s=e.includes("outage")||e.includes("advisory")||e.includes("statement")||e.includes("outlook")||e.includes("forecast")?y("--calcite-color-status-info"):e.includes("watch")||e.includes("alert")?y("--calcite-color-status-warning"):e.includes("outage")||e.includes("emergency")||e.includes("warning")||e.includes("immediate")||e.includes("danger")?y("--calcite-color-status-danger"):"#fff",i=new A(s).toRgb();return new _({data:{type:"CIMSymbolReference",symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[...i,64]},{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[4.75,4.75],lineDashEnding:"HalfPattern",offsetAlongLine:0}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[...i,255]}]}}})}async getAdvisory(){const{attributes:{url:t}}=this;this.content=o("calcite-loader",{label:"Loading advisory..."});try{const e=await(await fetch(t)).json(),{areaDesc:s,description:i,instruction:n}=e.properties,r=i.split(`

`);this.content=o("div",{class:g.advisory},o("div",null,s),r.map(c=>c.includes("https")?null:o("div",null,c.replace("* ",""))),n?o("div",null,n.replace(`
`," ").replace("  "," ")):null)}catch(e){console.log("advisory content",e),this.content=o("calcite-notice",{icon:l.error,kind:"danger",open:!0,scale:u.scale},o("div",{slot:"message"},"An error occurred loading advisory info"),o("calcite-link",{slot:"link",onclick:this.getAdvisory.bind(this)},"Try again"))}}iconAndStyle(t){const e=t.toLowerCase(),s=e.includes("outage")||e.includes("advisory")||e.includes("statement")||e.includes("outlook")||e.includes("forecast")?{icon:l.info,style:"--calcite-color-status-info"}:e.includes("watch")||e.includes("alert")?{icon:l.alert,style:"--calcite-color-status-warning"}:e.includes("outage")||e.includes("emergency")||e.includes("warning")||e.includes("immediate")||e.includes("danger")?{icon:l.danger,style:"--calcite-color-status-danger"}:{icon:"",style:""};return{icon:s.icon,style:`--calcite-list-label-text-color: var(${s.style}); --calcite-list-icon-color: var(${s.style});`}}listItemSelectEvent(){this.container.selected?(this.emit("show-graphic",this.feature),this.hidden=!1):(this.emit("hide-graphic"),this.hidden=!0,this.renderNow())}render(){const{colorType:t,scale:e}=u,{attributes:{expiration:s,prod_type:i},content:n,hidden:r}=this,c=f.fromISO(s).setZone("America/Los_Angeles");return f.now().setZone("America/Los_Angeles")>c&&(this.visible=!1),o("calcite-list-item",{class:h,description:`Expires ${c.toFormat("ccc h:mm a")}`,"icon-start":this.iconAndStyle(i).icon,label:i,scale:e,style:t==="dark"?this.iconAndStyle(i).style:this.iconAndStyle(i).style,afterCreate:b=>{b.addEventListener("calciteListItemSelect",this.listItemSelectEvent.bind(this))}},o("div",{class:g.content,hidden:r,slot:"content-bottom"},n))}};d([p({aliasOf:"feature.attributes"})],a.prototype,"attributes",2);d([p()],a.prototype,"hidden",2);d([p()],a.prototype,"content",2);a=d([w("AdvisoryItem")],a);export{a as default};
