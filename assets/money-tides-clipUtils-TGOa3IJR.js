const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/money-tides-intersectsOperator-BB0b6jS6.js","assets/money-tides-ProjectionTransformation-i8fsyL0P.js","assets/money-tides-Point2D-BcD_ruOp.js","assets/money-tides-Envelope2D-BqkCDX9b.js","assets/money-tides-Transformation2D-BzyNYhyU.js","assets/money-tides-SimpleGeometryCursor-B92kdZ15.js","assets/money-tides-jsxFactory-Bi29TlcS.js","assets/money-tides-config-Dy31BTur.js","assets/index-CXYhGA5b.js","assets/index-CEPnQygF.css","assets/money-tides-index-Bz5uSspo.js","assets/money-tides-runtime-BTGwkf2p.js","assets/runtime-OCMtRbrJ.css","assets/money-tides-OperatorDefinitions-DP7_WWTp.js","assets/money-tides-app-config-BzZR01Jy.js","assets/money-tides-ReactiveMap--SkC3kWW.js","assets/money-tides-messageBundle-CHZSgPji.js","assets/money-tides-index-BSQMl5Dg.js","assets/money-tides-jsonConverter-DYrPnSG9.js","assets/money-tides-OperatorIntersects-BvKUZGQx.js","assets/money-tides-apiConverter-NBC3Imij.js","assets/money-tides-containsOperator-BySovqQD.js"])))=>i.map(i=>d[i]);
import{_ as q}from"./index-CXYhGA5b.js";import{co as C,cq as L,_ as V}from"./money-tides-app-config-BzZR01Jy.js";import{c as E}from"./money-tides-PixelBlock-C_B4xzd2.js";function b(e,h){if(e.spatialReference.equals(h))return e;const t=L(e.spatialReference),i=L(h);if(t===i)return e;const a=t/i;return{x:e.x*a,y:e.y*a}}async function Q(e,h,t){if(t.type==="extent")return F(e,h,t);const{width:i,height:a}=e,n=new Uint8Array(i*a);return(await q(async()=>{const{execute:r}=await import("./money-tides-intersectsOperator-BB0b6jS6.js").then(o=>o.i);return{execute:r}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]))).execute(h,t)?t.type==="polyline"?G(e,h,t):(await q(async()=>{const{execute:r}=await import("./money-tides-containsOperator-BySovqQD.js").then(o=>o.c);return{execute:r}},__vite__mapDeps([21,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20]))).execute(t,h)?e:j(e,h,t):new E({pixelType:e.pixelType,width:i,height:a,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function j(e,h,t){if(!e)return e;const{width:i,height:a}=e,n=$({geometry:t,size:[i,a],srcExtent:h,srcMask:e.mask});return new E({pixelType:e.pixelType,width:i,height:a,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function $(e){const{geometry:h,size:t,srcExtent:i,srcMask:a}=e,[n,r]=t;let o;const l=i.width/n,y=i.height/r,{xmin:m,ymax:x}=i;if(h.type==="extent"){const c=(h.xmin-m)/l,s=(h.xmax-m)/l,p=(x-h.ymax)/y,f=(x-h.ymin)/y;o=[[[c,p],[c,f],[s,f],[s,p],[c,p]]]}else o=h.rings.map(c=>c.map(([s,p])=>[(s-m)/l,(x-p)/y]));return B(o,t,a)}function B(e,h,t){const[i,a]=h,n=new OffscreenCanvas(i,a).getContext("2d");n.fillStyle="#f00",n.beginPath(),e.forEach(m=>{n.moveTo(m[0][0],m[0][1]);for(let x=0;x<m.length;x++)n.lineTo(m[x][0],m[x][1]);n.closePath()}),n.fill();const r=n.getImageData(0,0,i,a).data,o=i*a,l=new Uint8Array(o);let y=!1;for(let m=0;m<o;m++)t&&!t[m]||(r[4*m+3]>127?l[m]=255:y=!0);return y||t?l:void 0}function F(e,h,t){const{width:i,height:a}=e,n=new Uint8Array(i*a),r=h.width/i,o=h.height/a;if(t.width/r<.5||t.height/o<.5)return new E({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});const{xmin:l,xmax:y,ymin:m,ymax:x}=h,{xmin:c,xmax:s,ymin:p,ymax:f}=t,u=Math.max(l,c),_=Math.min(y,s),R=Math.max(m,p),I=Math.min(x,f),S=.5*r,T=.5*o;if(_-u<S||I-R<T||_<l+S||u>y-S||R>x-T||I<m+T)return new E({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});const v=Math.max(0,(u-l)/r),z=Math.min(i,Math.max(0,(_-l)/r)),A=Math.max(0,(x-I)/o),g=Math.min(a,Math.max(0,(x-R)/o)),M=Math.round(v),w=Math.round(z)-1,d=Math.round(A),P=Math.round(g)-1;if(M===w&&v%1>.5&&z%1<.5||d===P&&A%1>.5&&g%1<.5)return new E({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});if(M===0&&d===0&&w===i&&P===a)return e;const U=e.mask;for(let k=d;k<=P;k++)for(let D=M;D<=w;D++){const O=k*i+D;n[O]=U?U[O]:255}return new E({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]})}function G(e,h,t){const{width:i,height:a}=e,n=new Uint8Array(i*a),r=h.width/i,o=h.height/a,{xmin:l,ymax:y}=h,{paths:m}=t,x=e.mask;for(let c=0;c<m.length;c++){const s=m[c];for(let p=0;p<s.length-1;p++){const[f,u]=s[p],[_,R]=s[p+1],I=Math.min(u,R),S=Math.max(u,R),T=Math.max(0,Math.floor((y-S)/o)),v=Math.min(a-1,Math.floor((y-I)/o));if(!(v<T))if(T===v){const z=Math.min(f,_),A=Math.max(f,_),g=Math.max(0,Math.floor((z-l)/r)),M=Math.min(i-1,Math.floor((A-l)/r));if(M<g)continue;const w=T*i;for(let d=w+g;d<=w+M;d++)n[d]=x?x[d]:255}else{const z=(f-l)/r,A=(_-f)/(R-u)/r,g=o*A;for(let M=T;M<=v;M++){const w=A*(y-M*o-u)+z,d=Math.max(0,Math.floor(g>0?w-g:w)),P=Math.min(i-1,Math.floor(g>0?w:w-g));if(P<d)continue;const U=M*i;for(let k=U+d;k<=U+P;k++)n[k]=x?x[k]:255}}}}return new E({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]})}function W(e,h){const{extent:t}=H(e,h,new V({x:e.pixelSize.x,y:e.pixelSize.y,spatialReference:e.spatialReference})),{extent:i}=e.extent;if(t.xmax=Math.min(t.xmax,i.xmax),t.ymax=Math.min(t.ymax,i.ymax),t.xmin<t.xmax&&t.ymin<t.ymax){const{x:a,y:n}=e.pixelSize,r=Math.round(t.width/a),o=Math.round(t.height/n);e.extent=t,e.width=r,e.height=o}}function H(e,h,t,i=!0){const{spatialReference:a}=e,{x:n,y:r}=b(t,a);let o,l,y;const m=h.type==="extent"?h:h.extent;let{xmin:x,xmax:c,ymax:s,ymin:p}=m;const{xmin:f,ymax:u}=e.extent;return i?(x=f+(x>f?n*Math.round((x-f)/n):0),s=u-(s<u?r*Math.round((u-s)/r):0),c=f+(c>f?n*Math.round((c-f)/n):0),p=u-(p<u?r*Math.round((u-p)/r):0),o=new C({xmin:x,ymax:s,xmax:c,ymin:p,spatialReference:a}),l=Math.round(o.width/n),y=Math.round(o.height/r)):(l=Math.floor((c-x)/n+.8),y=Math.floor((s-p)/r+.8),x=f+(x>f?n*Math.floor((x-f)/n+.1):0),s=u-(s<u?r*Math.floor((u-s)/r+.1):0),c=x+l*n,p=s-y*r,o=new C({xmin:x,ymax:s,xmax:c,ymin:p,spatialReference:a})),{extent:o,width:l,height:y}}export{$ as h,W as l,H as p,Q as r};
