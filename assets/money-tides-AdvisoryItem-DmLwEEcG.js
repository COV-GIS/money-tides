import{aD as b,N as h,aE as i,aj as g,m,c as S}from"./money-tides-jsxFactory-uxllTQB8.js";import"./money-tides-config-BVnrMf5g.js";import{e7 as u,gG as y,bg as w,ek as A,gw as r}from"./money-tides-app-config-DspwKZVt.js";import"./index-BfHNWA4H.js";import"./money-tides-index-Bz5uSspo.js";import"./money-tides-runtime-BTGwkf2p.js";import"./money-tides-ReactiveMap-C-rbPDGG.js";import"./money-tides-messageBundle-C8vtbyJo.js";import"./money-tides-index-BSQMl5Dg.js";var _=Object.defineProperty,C=Object.getOwnPropertyDescriptor,d=(e,t,s,o)=>{for(var n=o>1?void 0:o?C(t,s):t,l=e.length-1,c;l>=0;l--)(c=e[l])&&(n=(o?c(t,s,n):c(n))||n);return o&&n&&_(t,s,n),n};const p="advisory-item",f={advisory:`${p}_advisory`,content:`${p}_content`},v="advisory-item-content-handle";let a=class extends b{constructor(e){super(e),this.hidden=!0,this.content=null}get container(){return this._container}set container(e){this._container=e}postInitialize(){const{feature:e}=this;e.symbol=this.createSymbol(e.attributes.prod_type),this.addHandles(h(()=>u.colorType,this.createSymbol.bind(this,e.attributes.prod_type))),this.addHandles(h(()=>this.hidden,()=>{this.removeHandles(v),this.getAdvisory()}),v)}createSymbol(e){const t=e.toLowerCase(),s=t.includes("outage")||t.includes("advisory")||t.includes("statement")||t.includes("outlook")||t.includes("forecast")?y("--calcite-color-status-info"):t.includes("watch")||t.includes("alert")?y("--calcite-color-status-warning"):t.includes("outage")||t.includes("emergency")||t.includes("warning")||t.includes("immediate")||t.includes("danger")?y("--calcite-color-status-danger"):"#fff",o=new w(s).toRgb();return new A({data:{type:"CIMSymbolReference",symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[...o,64]},{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[4.75,4.75],lineDashEnding:"HalfPattern",offsetAlongLine:0}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[...o,255]}]}}})}async getAdvisory(){const{attributes:{url:e}}=this;this.content=i("calcite-loader",{label:"Loading advisory..."});try{const t=await(await fetch(e)).json(),{areaDesc:s,description:o,instruction:n}=t.properties,l=o.split(`

`);this.content=i("div",{class:f.advisory},i("div",null,s),l.map(c=>c.includes("https")?null:i("div",null,c.replace("* ",""))),n?i("div",null,n.replace(`
`," ").replace("  "," ")):null)}catch(t){console.log("advisory content",t),this.content=i("calcite-notice",{icon:r.error,kind:"danger",open:!0,scale:u.scale},i("div",{slot:"message"},"An error occurred loading advisory info"),i("calcite-link",{slot:"link",onclick:this.getAdvisory.bind(this)},"Try again"))}}iconAndStyle(e){const t=e.toLowerCase(),s=t.includes("outage")||t.includes("advisory")||t.includes("statement")||t.includes("outlook")||t.includes("forecast")?{icon:r.info,style:"--calcite-color-status-info"}:t.includes("watch")||t.includes("alert")?{icon:r.alert,style:"--calcite-color-status-warning"}:t.includes("outage")||t.includes("emergency")||t.includes("warning")||t.includes("immediate")||t.includes("danger")?{icon:r.danger,style:"--calcite-color-status-danger"}:{icon:"",style:""};return{icon:s.icon,style:`--calcite-list-label-text-color: var(${s.style}); --calcite-list-icon-color: var(${s.style});`}}render(){const{colorType:e,scale:t}=u,{attributes:{expiration:s,prod_type:o},content:n,hidden:l}=this,c=g.fromISO(s).setZone("America/Los_Angeles");return g.now().setZone("America/Los_Angeles")>c&&(this.visible=!1),i("calcite-list-item",{class:p,description:`Expires ${c.toFormat("ccc h:mm a")}`,"icon-start":this.iconAndStyle(o).icon,label:o,scale:t,style:e==="dark"?this.iconAndStyle(o).style:this.iconAndStyle(o).style},i("div",{class:f.content,hidden:l,slot:"content-bottom"},n))}};d([m()],a.prototype,"hidden",2);d([m({aliasOf:"feature.attributes"})],a.prototype,"attributes",2);d([m()],a.prototype,"content",2);a=d([S("AdvisoryItem")],a);export{a as default};
