import{as as v,Z as f,at as s,M as p,m as h,b}from"./money-tides-jsxFactory-CmVu17M-.js";import"./money-tides-config-Dy31BTur.js";import{gt as g,e5 as S,ds as m,gb as _}from"./money-tides-app-config-dTmgntDM.js";import"./index-DWCK4KRz.js";import"./money-tides-index-Bz5uSspo.js";import"./money-tides-runtime-BTGwkf2p.js";import"./money-tides-ReactiveMap-DFuaAS07.js";import"./money-tides-messageBundle-BOeQ4wnZ.js";import"./money-tides-index-BSQMl5Dg.js";var A=Object.defineProperty,I=Object.getOwnPropertyDescriptor,l=(t,i,a,o)=>{for(var e=o>1?void 0:o?I(i,a):i,n=t.length-1,r;n>=0;n--)(r=t[n])&&(e=(o?r(i,a,e):r(e))||e);return o&&e&&A(i,a,e),e};const d="advisory-item",y={advisory:`${d}_advisory`,content:`${d}_content`},u="advisory-item-content-handle";let c=class extends v{constructor(t){super(t),this.hidden=!0,this.content=null}get container(){return this._container}set container(t){this._container=t}postInitialize(){const{feature:t}=this;t.symbol=this.createSymbol(g[t.attributes.prod_type]),this.addHandles(f(()=>this.hidden,()=>{this.removeHandles(u),this.getAdvisory()}),u)}clear(){this.emit("hide-graphic"),this.container.selected=!1,this.hidden=!0}createSymbol(t){return new S({data:{type:"CIMSymbolReference",symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[...t,128]},{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[4.75,4.75],lineDashEnding:"HalfPattern",offsetAlongLine:0}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:2.25,color:[...t,255]}]}}})}async getAdvisory(){const{attributes:{url:t}}=this;this.content=s("calcite-loader",{label:"Loading advisory..."});try{const i=await(await fetch(t)).json(),{areaDesc:a,description:o,instruction:e}=i.properties,n=o.split(`

`);this.content=s("div",{class:y.advisory},s("div",null,a),n.map(r=>r.includes("https")?null:s("div",null,r.replace("* ",""))),e?s("div",null,e.replace(`
`," ").replace("  "," ")):null)}catch(i){console.log("advisory content",i),this.content=s("calcite-notice",{icon:_.error,kind:"danger",open:!0,scale:m.scale},s("div",{slot:"message"},"An error occurred loading advisory info"),s("calcite-link",{slot:"link",onclick:this.getAdvisory.bind(this)},"Try again"))}}listItemSelectEvent(){const{feature:t}=this;this.container.selected?(this.emit("show-graphic",t),this.hidden=!1):(this.emit("hide-graphic"),this.hidden=!0)}render(){const{scale:t}=m,{attributes:{expiration:i,prod_type:a},content:o,hidden:e}=this,n=p.fromISO(i).setZone("America/Los_Angeles");return p.now().setZone("America/Los_Angeles")>n&&(this.visible=!1),s("calcite-list-item",{class:d,description:`Expires ${n.toFormat("ccc h:mm a")}`,label:a,scale:t,afterCreate:r=>{r.addEventListener("calciteListItemSelect",this.listItemSelectEvent.bind(this))}},s("div",{class:y.content,hidden:e,slot:"content-bottom"},o))}};l([h({aliasOf:"feature.attributes"})],c.prototype,"attributes",2);l([h()],c.prototype,"hidden",2);l([h()],c.prototype,"content",2);c=l([b("AdvisoryItem")],c);export{c as default};
